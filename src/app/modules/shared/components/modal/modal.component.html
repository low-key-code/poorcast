<div class="overlay" (click)="closeModal()"></div>
<form class="modal" *ngIf="modal$ | async as modal">
  <div class="modal__main">
    <app-solo-icon
        [iconName]="'closeCircle'"
        [appIconSize]="1.28"
        class="modal__main--close"
        (click)="closeModal()"
      ></app-solo-icon>
    <h2 class="modal__main--title">{{ modal.title }}</h2>
    <div class="modal__main--fieldsets">
      <app-fieldset
        *ngFor="let fieldset of modal.fieldsets"
        [legend]="fieldset.name"
      >
        <ng-container
          *ngFor="let input of fieldset.inputs"
          [ngSwitch]="input.type"
        >
          <ng-template ngSwitchCase="text">
            <app-text-input
              formControlName="input.formControlName"
              [label]="input.label"
              [hidden]="input.hidden"
            ></app-text-input>
          </ng-template>

          <ng-template ngSwitchCase="select">
            <app-select-input
              formControlName="input.formControlName"
              [label]="input.label"
              [hidden]="input.hidden"
            ></app-select-input>
          </ng-template>
        </ng-container>
      </app-fieldset>
    </div>
    <div class="modal__main--icon" *ngIf="modal.icon">
      <app-solo-icon
        [iconName]="modal.icon.iconName"
        [appIconSize]="modal.icon.iconSize"
      ></app-solo-icon>
    </div>
  </div>
  <div class="modal__btns">
    <button
      *ngFor="let button of modal.modalButtons"
      [type]="button.type"
      (click)="(button.clickFn())"
      class="btn"
      [ngClass]="{
        'btn-primary': button.type === 'submit',
        'btn-neutral': button.type === 'button'
      }"
      [attr.data-test]="button.dataTest"
    >
      {{ button.buttonText }}
    </button>
  </div>
</form>
